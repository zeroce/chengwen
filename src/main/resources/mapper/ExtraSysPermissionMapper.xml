<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.zeroce.design.chengwen.mapper.ExtraSysPermissionMapper">
  <resultMap id="BaseResultMap" type="cn.zeroce.design.chengwen.entity.SysPermission">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Sat Mar 14 23:46:11 CST 2020.
    -->
    <id column="id" jdbcType="INTEGER" property="id" />
    <result column="title" jdbcType="VARCHAR" property="title" />
    <result column="resources" jdbcType="VARCHAR" property="resources" />
    <result column="description" jdbcType="VARCHAR" property="description" />
    <result column="pid" jdbcType="INTEGER" property="pid" />
    <result column="method" jdbcType="VARCHAR" property="method" />
    <result column="type" jdbcType="VARCHAR" property="type" />
  </resultMap>

  <resultMap id="PermsDTOMap" type="cn.zeroce.design.chengwen.dto.PermsDTO">
    <id column="id" property="id"></id>
    <result column="resources" property="label"></result>
  </resultMap>

  <select id="selectDistTitle" resultType="java.lang.String">
    select distinct title
    from sys_permission
    where title is not null;
  </select>

  <select id="selectPermsByRoleId" resultType="java.lang.String">
    select
    sp.resources
    from sys_roles_permission srp
    left join sys_permission sp on srp.sys_permission_id = sp.id
    where srp.sys_roles_id = #{roleId};
  </select>

  <select id="selectPermsByTitle" resultType="java.lang.String">
    select code from sys_permission where title = #{title};
  </select>

  <select id="selectPermsCodeByTitle" resultMap="PermsDTOMap">
    select
    id, resources
    from sys_permission
    where title = #{title};
  </select>

  <select id="selectPermsCodeByPid" resultMap="PermsDTOMap">
    select
    id, resources
    from sys_permission
    where pid = #{pid}
  </select>

  <select id="selectPermsIdByRoleId" resultMap="BaseResultMap">
    select
    sp.id, sp.pid
    from sys_permission sp
    left join sys_roles_permission srp on sp.id = srp.sys_permission_id
    where srp.sys_roles_id = #{roleId}
  </select>

  <select id="selectAllPermsTitle" resultMap="BaseResultMap">
    select * from sys_permission where pid = 0;
  </select>

</mapper>